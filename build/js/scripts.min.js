const player = document.querySelector('.player-1');
const video1 = player.querySelector('.viewer-1');
const progress1 = player.querySelector('.progress-1');
const progressBar1 = player.querySelector(['.progress__filled-1']);

function togglePlay() {
	video1[video1.paused ? 'play' : 'pause']();
}

function handleProgress() {
	const percent = (video1.currentTime / video1.duration) * 100;
	progressBar1.style.flexBasis = `${percent}%`;
}

function scrub(e) {
	const scrubTime = (e.offsetX / progress1.offsetWidth) * video1.duration;
	video1.currentTime = scrubTime;
}
video1.addEventListener('click', togglePlay);
video1.addEventListener('timeupdate', handleProgress);
let mousedown = false;
progress1.addEventListener('click', scrub);
progress1.addEventListener('mousemove', e => mousedown && scrub(e));
progress1.addEventListener('mousedown', () => {
	mousedown = true;
});
progress1.addEventListener('mouseup', () => {
	mousedown = false;
});
const player2 = document.querySelector('.player-2');
const video2 = player2.querySelector('.viewer-2');
const progress2 = player2.querySelector('.progress-2');
const progressBar2 = player2.querySelector(['.progress__filled-2']);

function togglePlay2() {
	video2[video2.paused ? 'play' : 'pause']();
}

function handleProgress2() {
	const percent = (video2.currentTime / video2.duration) * 100;
	progressBar2.style.flexBasis = `${percent}%`;
}

function scrub2(e) {
	const scrubTime = (e.offsetX / progress2.offsetWidth) * video2.duration;
	video2.currentTime = scrubTime;
}
video2.addEventListener('click', togglePlay2);
video2.addEventListener('timeupdate', handleProgress2);
let mousedown2 = false;
progress2.addEventListener('click', scrub2);
progress2.addEventListener('mousemove', e => mousedown && scrub2(e));
progress2.addEventListener('mousedown', () => {
	mousedown2 = true;
});
progress2.addEventListener('mouseup', () => {
	mousedown2 = false;
});
$('.carousel-produced').carousel({
	interval: false
})
$('.carousel-standing').carousel({
	interval: false
})

$('.carousel-example-photo').carousel({
	interval: false
})

$('.carousel-reviews').carousel({
	interval: false
})



function sendEmail() {
	var myform = $("form#form-request")
	var params = myform.serializeArray().reduce(function (obj, item) {
		obj[item.name] = item.value;
		return obj;
	}, {});
	event.preventDefault();
	myform.find("button").text("Отправляем...");
	emailjs.send("default_service", "tents", params)
		.then(function () {
			$("#request").modal('hide')
			$("#thanks").modal('show')
			myform.find("button").text("отправить заявку");
		}, function (err) {
			alert("Send email failed!\r\n Response:\n " + JSON.stringify(err));
			myform.find("button").text("отправить заявку");
		});
}
(function () {
	emailjs.init("user_DNIJakmte9ZrjJG8xKmUY");
})();

(function () {
	var forms = document.getElementsByClassName('form-request');
	window.addEventListener('load', function () {
		var validation = Array.prototype.filter.call(forms, function (form) {
			form.addEventListener('submit', function (event) {
				if (form.checkValidity() === false) {
					event.preventDefault();
					event.stopPropagation();
				}
				if (form.checkValidity()) {
					sendEmail()
				}
				form.classList.add('was-validated');

			}, false);

		});
	}, false);
})();
$("#phone").mask("+7(999) 999-9999");
$(document).ready(function () {
	var waterwheel = $("#waterwheel ").waterwheelCarousel({
		flankingItems: 3,
		opacityMultiplier: 1,
		separation: 200,
	});

	$('#prev').bind('click', function () {
		waterwheel.prev();
		return false
	});

	$('#next').bind('click', function () {
		waterwheel.next();
		return false;
	});
});
new WOW({
	offset: 20,
	mobile: false,
}).init()